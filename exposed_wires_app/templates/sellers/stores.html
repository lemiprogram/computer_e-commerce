{% extends "layout.html" %}

{% block content %}
<div class="min-h-screen bg-bg-100 p-8">
  <div class="max-w-5xl mx-auto bg-bg-300 shadow-xl rounded-2xl p-8">

    <h1 class="text-3xl font-bold text-primary-100 mb-8">My Store</h1>

    {% if store %}
      <div class="flex items-center justify-between mb-6">
        <h1 class="text-3xl font-bold text-primary-100 flex items-center gap-2">
          {{ store.name }}
          {% if store.verified %}
            <span title="Verified Store">‚úÖ</span>
          {% endif %}
        </h1>
        <a href="{% url 'edit_store' store.id %}"
           class="bg-primary-100 hover:bg-primary-200 text-white px-4 py-2 rounded-lg shadow">
          ‚úèÔ∏è Edit Store
        </a>
      </div>

      <!-- Store Details -->
      <div class="flex gap-6 mb-10">
        {% if store.profile_image %}
          <img src="{{ store.profile_image.url }}" alt="{{ store.name }}"
               class="w- h-64 object-contain rounded-lg shadow">
        {% endif %}
        <div>
          <p class="text-text-100 mb-2"><strong>Description:</strong> {{ store.description }}</p>
          <p class="text-text-100 mb-2"><strong>City:</strong> {{ store.city }}</p>
          <p class="text-text-100 mb-2"><strong>Address:</strong> {{ store.address }}</p>
          <p class="text-text-100 mb-2"><strong>Phone:</strong> {{ store.phone }}</p>
          <p class="text-text-100 mb-2"><strong>Website:</strong> 
            <a href="{{ store.website }}" class="text-primary-100 hover:underline" target="_blank">
              {{ store.website }}
            </a>
          </p>
          <p class="text-text-200 text-sm mt-2">Created on {{ store.created_at|date:"M d, Y" }}</p>
          {% if current_seller.store_role == 'admin' %} <p class="text-text-100 mb-2"><strong>Access Token:</strong> {{ store.access_token }}</p> {% endif %}
          
          
        </div>
      </div>

      <!-- Staff Section -->
      <div class="bg-bg-200 p-6 rounded-xl shadow mb-10">
        <h2 class="text-xl font-bold text-text-100 mb-4">Store Staff</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          {% for seller in staff %}
            <div class="bg-bg-300 rounded-lg shadow-lg p-4 text-center">
              {% if seller.user.profile.profile_pic %}
                <img src="{{ seller.user.profile.profile_pic.url }}" 
                     class="w-20 h-20 mx-auto rounded-full mb-3 object-cover">
              {% else %}
                <div class="w-20 h-20 mx-auto rounded-full bg-bg-200 flex items-center justify-center mb-3 text-text-200">
                  üë§
                </div>
              {% endif %}
              <h3 class="font-semibold text-text-100">{{ seller.user.username }}</h3>
              <p class="text-sm text-text-200">
                {% if seller.store_role == 'admin' %} üõ°Ô∏è Admin {% else %} üë• Staff {% endif %}
              </p>
            </div>
          {% empty %}
            <p class="text-text-200">No staff members yet.</p>
          {% endfor %}
        </div>
      </div>
    {% else %}
      <!-- User has no store yet -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        
        <!-- Join a Store -->
        <div class="bg-white rounded-xl shadow-md p-8 flex flex-col items-center text-center hover:shadow-lg transition">
          <div class="w-20 h-20 flex items-center justify-center rounded-full bg-primary-100 text-white text-3xl mb-4">
            ü§ù
          </div>
          <h3 class="text-xl font-semibold text-text-100 mb-2">Join a Store</h3>
          <p class="text-text-200 mb-4">Already part of a business? Join an existing store managed by your team.</p>
          <a href="{% url 'join_store' %}" class="bg-primary-100 text-white px-5 py-2 rounded-lg hover:bg-primary-200">Join Store</a>
        </div>

        <!-- Create a Store -->
        <div class="bg-white rounded-xl shadow-md p-8 flex flex-col items-center text-center hover:shadow-lg transition">
          <div class="w-20 h-20 flex items-center justify-center rounded-full bg-accent-200 text-white text-3xl mb-4">
            üè¨
          </div>
          <h3 class="text-xl font-semibold text-text-100 mb-2">Create a Store</h3>
          <p class="text-text-200 mb-4">Start fresh and create your own store to sell products directly.</p>
          <a href="{% url 'create_store' %}" class="bg-accent-200 text-white px-5 py-2 rounded-lg hover:bg-accent-100">Create Store</a>
        </div>

      </div>
    {% endif %}

  </div>
</div>
{% endblock %}
