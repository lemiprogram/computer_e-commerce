<!-- Search Bar -->
<div class="hidden md:flex flex-1 mx-6 relative">
  <div class="flex w-full">
    <input type="text" id="search-input" placeholder="Search categories..." 
           class="w-full px-4 py-2 pr-10 bg-white rounded-l-full focus:outline-none focus:ring-2 focus:ring-accent-100 font-bold">
    <button id="search-btn" 
            class="rounded-r-full bg-primary-200 text-black hover:text-accent-100 cursor-pointer px-4">
      <!-- Search Icon -->
      <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 cursor-pointer" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M21 21l-4.35-4.35m0 0A7.5 7.5 0 1110.5 3a7.5 7.5 0 016.15 13.65z" />
      </svg>
    </button>
  </div>

  <!-- Dropdown Menu -->
  <ul id="category-dropdown" 
      class="absolute top-full left-0 w-full bg-white shadow-lg rounded-b-lg hidden max-h-60 overflow-y-auto z-50">
  </ul>
</div>
<div id="data" class="hidden" data-url-categories="{% url 'get_categories'%}"></div>
<script>
  // Example categories (you can replace this with data from Django context or API)
  const categories = []

  const searchInput = document.getElementById("search-input");
  const searchBtn = document.getElementById("search-btn");
  const categoryDropdown = document.getElementById("category-dropdown");

  // Function to filter categories
  function filterCategories(query) {
    return categories.filter(cat => cat.toLowerCase().includes(query.toLowerCase()));
  }

  // Show dropdown while typing
  searchInput.addEventListener("input", () => {
    const query = searchInput.value.trim();
    categoryDropdown.innerHTML = "";

    if (query.length === 0) {
      categoryDropdown.classList.add("hidden");
      return;
    }

    const results = filterCategories(query);

    if (results.length > 0) {
      results.forEach(cat => {
        const li = document.createElement("li");
        li.textContent = cat;
        li.className = "p-2 hover:bg-accent-100 cursor-pointer";
        li.addEventListener("click", () => {
          searchInput.value = cat; // set clicked value
          categoryDropdown.classList.add("hidden");
        });
        categoryDropdown.appendChild(li);
      });
      categoryDropdown.classList.remove("hidden");
    } else {
      categoryDropdown.classList.add("hidden");
    }
  });

  // Handle search (Enter key or button)
  function handleSearch() {
    const query = searchInput.value.trim();
    if (query.length === 0) return;

    // Redirect to category page with query filter
    // Example: /categories/<category>/?q=<query>
    window.location.href = `/search/${encodeURIComponent(query)}`;
  }

  // Search button click
  searchBtn.addEventListener("click", handleSearch);

  // Enter key press
  searchInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      e.preventDefault();
      handleSearch();
    }
  });

  // Close dropdown if clicked outside
  document.addEventListener("click", (e) => {
    if (!searchInput.contains(e.target) && !categoryDropdown.contains(e.target)) {
      categoryDropdown.classList.add("hidden");
    }
  });
</script>
