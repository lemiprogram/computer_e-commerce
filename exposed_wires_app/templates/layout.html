{% load static %}
<!DOCTYPE html>
<html>
<head>
    
    
    <meta name="csrf-token" content="{{ csrf_token }}">
    <title>{% block title %} Exposed Wires {% endblock %}</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style type="text/tailwindcss">      
        @theme {
    --color-primary-100:#005B99;
    --color-primary-200:#4e88ca;
    --color-primary-300:#b7e9ff;
    --color-accent-100:#FFD700;
    --color-accent-200:#e9aa2b;
    --color-text-100:#333333;
    --color-text-200:#5c5c5c;
    --color-bg-100:#F5F5F5;
    --color-bg-200:#ebebeb;
    --color-bg-300:#c2c2c2;
      
      
      
            --color-faded-black:#000000a5;
            --color-faded-grey:#00000005;
        }    

        @layer base {
            body {
                @apply text-text-100 bg-bg-100;
            }
        }
    </style>
</head>
<body class="bg-bg-100">
        <script>
        function getCSRFToken() {
    const tokenMeta = document.querySelector('meta[name="csrf-token"]');
    return tokenMeta ? tokenMeta.getAttribute("content") : "";
}
        // Notification helper
function notify(message, type = "info") {
    const container = document.getElementById("notifications") || (() => {
        const div = document.createElement("div");
        div.id = "notifications";
        div.className = "fixed top-4 right-4 space-y-2 z-50";
        document.body.appendChild(div);
        return div;
    })();

    const note = document.createElement("div");
    note.className = `px-4 py-2 rounded-lg shadow text-white transition-opacity duration-500
        ${type === "success" ? "bg-green-500" : ""}
        ${type === "error" ? "bg-red-500" : ""}
        ${type === "info" ? "bg-blue-500" : ""}`;

    note.textContent = message;

    container.appendChild(note);

    setTimeout(() => {
        note.style.opacity = "0";
        setTimeout(() => note.remove(), 500);
    }, 3000);
}
// GET
async function get_data(url) {
    const res = await fetch(url);
    return await res.json();
}

// POST
async function post_data(url, postData) {
    return await fetch(url, {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": getCSRFToken()
        },
        body: JSON.stringify(postData)
    }).then(res => res.json())
      .then(data => data);
}

async function put_data(url, putData) {
    return await fetch(url, {
        method: "PUT",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": getCSRFToken()
        },
        body: JSON.stringify(putData)
    }).then(res => res.json());
}

async function patch_data(url, patchData) {
    return await fetch(url, {
        method: "PATCH",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": getCSRFToken()
        },
        body: JSON.stringify(patchData)
    }).then(res => res.json())
      .then(data => data);  
}

async function delete_data(url) {
    return await fetch(url, {
        method: "DELETE",
        headers: {
            "X-CSRFToken": getCSRFToken()
        }
    }).then(res => res.json());
}


        const BASE_URL = window.location.origin;

        const get_Categories_url = `${BASE_URL}/api/get/Categories/`;
        const get_Conditions_url = `${BASE_URL}/api/get/Conditions/`;
        const get_Stores_url = `${BASE_URL}/api/get/Stores/`;
        const get_Shoppers_url = `${BASE_URL}/api/get/Shoppers/`;
        const get_Sellers_url = `${BASE_URL}/api/get/Sellers/`;
        const get_Products_url = `${BASE_URL}/api/get/Products/`;
        const get_Orders_url = `${BASE_URL}/api/get/Orders/`;
        const get_Carts_url = `${BASE_URL}/api/get/Carts/`;
        const get_CartItems_url = `${BASE_URL}/api/get/CartItems/`;
        const get_Wishlists_url = `${BASE_URL}/api/get/Wishlists/`;
        const get_CustomUser_url = `${BASE_URL}/api/get/Customusers/`;
        const get_User_url = `${BASE_URL}/api/get/user`;

        

        const post_CartItems_url = `${BASE_URL}/api/post/CartItems`
        const patch_CartItems_url = `${BASE_URL}/api/patch/CartItems/`
        const patch_Stores_url = `${BASE_URL}/api/patch/Stores/`
        

        const delete_CustomUser_url = `${BASE_URL}/api/delete/Customusers/`;
        const delete_Products_url = `${BASE_URL}/api/delete/Products/`;
        const delete_CartItems_url = `${BASE_URL}/api/delete/CartItems/`;
        
        function getPrice(priceStr, discount){
            let price = Math.round(parseFloat(priceStr)*100) / 100;
            price = (price * (1 - (discount / 100)))
            return price.toFixed(2);
        }
    </script>
    {% if messages %}
        <div class="absolute top-4 right-4 space-y-2">
            {% for message in messages %}
                <div class="px-4 py-2 rounded-lg shadow text-white
                            {% if message.tags == 'success' %} bg-green-500 
                            {% elif message.tags == 'error' %} bg-red-500 
                            {% else %} bg-accent-200 {% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    {% block header %}
        {% if user.role == "seller" %}
            {% include 'includes/seller_header.html' %}
        {% elif user.role != "admin" %}
            {% include 'includes/shopper_header.html' %}
        {% endif %}
    {% endblock %}

    {% if user.role == "admin" %}
        <main class="min-h-screen flex">
            {% include 'includes/admin_sidbar.html' %}
            <section class="w-full h-screen overflow-y-scroll">{% block admin_content %}{% endblock %}</section>
        </main>
        {% endif %}
        <main class="">{% block content %}{% endblock %}</main>

    {% block footer %}
        {% if user.role != "admin" %}
            {% include 'includes/footer.html' %}
        {% endif %}
    {% endblock %}



    {% block scripts %}{% endblock %}
</body>
</html>
